# Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù†Ø¸Ø§Ù… Ù†ÙØ§Ø° (NAFATH) - Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙŠ TypeScript/Next.js/React

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙŠÙˆØ«Ù‚ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ø¨Ø± Ù†ÙØ§Ø° (NAFATH) Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù…Ø´Ø±ÙˆØ¹ LaravelØŒ Ù…Ø¹ ØªÙˆÙÙŠØ± ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù„ØªØ·Ø¨ÙŠÙ‚Ù‡ ÙÙŠ Ù…Ø´Ø±ÙˆØ¹ TypeScript/Next.js/React.

## ğŸ¯ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©

- âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø¹Ø¨Ø± ØªØ·Ø¨ÙŠÙ‚ Ù†ÙØ§Ø°
- âœ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„ÙˆØ«Ø§Ø¦Ù‚
- âœ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§ (Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ù„ØºØªÙŠÙ†)
- âœ… Ø­ÙØ¸ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©
- âœ… Ù†Ø¸Ø§Ù… callbacks Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
- âœ… Ù‚ÙˆØ§Ù„Ø¨ Ø¹Ù‚ÙˆØ¯ Ø¬Ø§Ù‡Ø²Ø© (3 Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ©)

## ğŸ› ï¸ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

### 1. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ù…Ù† Ù†ÙØ§Ø°

```bash
NAFATH_THUMBPRINT=your_certificate_thumbprint
NAFATH_ACCOUNT_ID=your_account_id
NAFATH_BASE_URL=https://apigw.sadq.sa
```

### 2. Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```sql
-- Ø¬Ø¯ÙˆÙ„ Ø­ÙØ¸ Ø·Ù„Ø¨Ø§Øª Ù†Ø§ÙØ°
CREATE TABLE nafath_requests (
    request_id VARCHAR(36) PRIMARY KEY,
    user_id BIGINT UNSIGNED NULL,
    national_id VARCHAR(20) NOT NULL,
    status ENUM('pending', 'approved', 'failed') DEFAULT 'pending',
    signed_file_path VARCHAR(255) NULL,
    first_name_ar VARCHAR(255) NULL,
    first_name_en VARCHAR(255) NULL,
    middle_name_ar VARCHAR(255) NULL,
    middle_name_en VARCHAR(255) NULL,
    third_name_ar VARCHAR(255) NULL,
    third_name_en VARCHAR(255) NULL,
    last_name_ar VARCHAR(255) NULL,
    last_name_en VARCHAR(255) NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_national_id (national_id),
    INDEX idx_status (status),
    INDEX idx_user_id (user_id)
);

-- Ø¬Ø¯Ø§ÙˆÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
CREATE TABLE investor_nafath_requests (
    request_id VARCHAR(36) PRIMARY KEY,
    national_id VARCHAR(20) NOT NULL,
    status ENUM('pending', 'approved', 'failed') DEFAULT 'pending',
    signed_file_path VARCHAR(255) NULL,
    first_name_ar VARCHAR(255) NULL,
    first_name_en VARCHAR(255) NULL,
    middle_name_ar VARCHAR(255) NULL,
    middle_name_en VARCHAR(255) NULL,
    third_name_ar VARCHAR(255) NULL,
    third_name_en VARCHAR(255) NULL,
    last_name_ar VARCHAR(255) NULL,
    last_name_en VARCHAR(255) NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE portal_logistice_nafath_requests (
    request_id VARCHAR(36) PRIMARY KEY,
    national_id VARCHAR(20) NOT NULL,
    status ENUM('pending', 'approved', 'failed') DEFAULT 'pending',
    signed_file_path VARCHAR(255) NULL,
    first_name_ar VARCHAR(255) NULL,
    first_name_en VARCHAR(255) NULL,
    middle_name_ar VARCHAR(255) NULL,
    middle_name_en VARCHAR(255) NULL,
    third_name_ar VARCHAR(255) NULL,
    third_name_en VARCHAR(255) NULL,
    last_name_ar VARCHAR(255) NULL,
    last_name_en VARCHAR(255) NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

## ğŸš€ APIs Ø§Ù„Ù…ØªÙˆÙØ±Ø©

### 1. Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©

**Endpoint:** `POST /api/nafath/initiate`

**Request Body:**
```typescript
interface InitiateRequest {
  national_id: string;
  user_id?: number;
}
```

**Response:**
```typescript
interface InitiateResponse {
  status: 'sent' | 'error';
  request_id: string;
  message?: string;
  code?: string;
  external_response: any;
}
```

**cURL Example:**
```bash
curl -X POST "https://your-domain.com/api/nafath/initiate" \
  -H "Content-Type: application/json" \
  -d '{
    "national_id": "1234567890",
    "user_id": 1
  }'
```

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨

**Endpoint:** `POST /api/nafath/check-status`

**Request Body:**
```typescript
interface CheckStatusRequest {
  national_id: string;
  user_id?: number;
}
```

**Response:**
```typescript
interface CheckStatusResponse {
  status: 'pending' | 'approved' | 'failed' | 'not_found';
  national_id: string;
  request_id: string;
  full_name_ar: string;
  signed_file_url?: string;
  message?: string;
}
```

### 3. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Callback Ù…Ù† Ù†ÙØ§Ø°

**Endpoint:** `POST /api/nafath/callback`

**Request Body (Ù…Ù† Ù†ÙØ§Ø°):**
```typescript
interface CallbackRequest {
  requestId: string;
  Status: number; // 0 = success, 1 = failed
  usersInfo?: Array<{
    FirstNameEn: string;
    FirstNameAr: string;
    MiddleNameEn: string;
    MiddleNameAr: string;
    ThirdNameEn: string;
    ThirdNameAr: string;
    LastNameEn: string;
    LastNameAr: string;
  }>;
}
```

### 4. ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯

**Endpoint:** `POST /api/nafath/sign`

**Request Body:**
```typescript
interface SignRequest {
  national_id: string;
  user_id?: number;
  contract_data: {
    company_name: string;
    city: string;
    neighborhood: string;
    house_type: string;
    contract_terms?: string;
    [key: string]: any;
  };
}
```

**Response:**
```typescript
interface SignResponse {
  signed: boolean;
  message: string;
  file_url?: string;
  error?: string;
}
```

## ğŸ“± ØªØ·Ø¨ÙŠÙ‚ ÙÙŠ TypeScript/Next.js

### 1. Types Ùˆ Interfaces

```typescript
// types/nafath.ts
export interface NafathRequest {
  request_id: string;
  user_id?: number;
  national_id: string;
  status: 'pending' | 'approved' | 'failed';
  signed_file_path?: string;
  first_name_ar?: string;
  first_name_en?: string;
  middle_name_ar?: string;
  middle_name_en?: string;
  third_name_ar?: string;
  third_name_en?: string;
  last_name_ar?: string;
  last_name_en?: string;
  created_at: string;
  updated_at: string;
}

export interface NafathConfig {
  thumbPrint: string;
  accountId: string;
  baseUrl: string;
}

export interface ContractData {
  company_name: string;
  city: string;
  neighborhood: string;
  house_type: string;
  contract_terms?: string;
  fullname?: string;
  national_id?: string;
  [key: string]: any;
}
```

### 2. Nafath Service Class

```typescript
// services/nafathService.ts
import axios, { AxiosResponse } from 'axios';

export class NafathService {
  private baseUrl: string;
  private config: NafathConfig;

  constructor(config: NafathConfig) {
    this.config = config;
    this.baseUrl = '/api/nafath'; // Your backend API base
  }

  /**
   * Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©
   */
  async initiate(nationalId: string, userId?: number): Promise<InitiateResponse> {
    try {
      const response: AxiosResponse<InitiateResponse> = await axios.post(
        `${this.baseUrl}/initiate`,
        {
          national_id: nationalId,
          user_id: userId,
        }
      );
      return response.data;
    } catch (error) {
      throw this.handleError(error);
    }
  }

  /**
   * Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
   */
  async checkStatus(nationalId: string, userId?: number): Promise<CheckStatusResponse> {
    try {
      const response: AxiosResponse<CheckStatusResponse> = await axios.post(
        `${this.baseUrl}/check-status`,
        {
          national_id: nationalId,
          user_id: userId,
        }
      );
      return response.data;
    } catch (error) {
      throw this.handleError(error);
    }
  }

  /**
   * ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯
   */
  async signContract(
    nationalId: string,
    contractData: ContractData,
    userId?: number
  ): Promise<SignResponse> {
    try {
      const response: AxiosResponse<SignResponse> = await axios.post(
        `${this.baseUrl}/sign`,
        {
          national_id: nationalId,
          user_id: userId,
          contract_data: contractData,
        }
      );
      return response.data;
    } catch (error) {
      throw this.handleError(error);
    }
  }

  /**
   * Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø©
   */
  async pollStatus(
    nationalId: string,
    userId?: number,
    interval: number = 3000,
    maxAttempts: number = 60
  ): Promise<CheckStatusResponse> {
    return new Promise((resolve, reject) => {
      let attempts = 0;
      
      const poll = async () => {
        try {
          attempts++;
          const result = await this.checkStatus(nationalId, userId);
          
          if (result.status === 'approved' || result.status === 'failed') {
            resolve(result);
          } else if (attempts >= maxAttempts) {
            reject(new Error('Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'));
          } else {
            setTimeout(poll, interval);
          }
        } catch (error) {
          reject(error);
        }
      };
      
      poll();
    });
  }

  private handleError(error: any): Error {
    if (error.response?.data?.message) {
      return new Error(error.response.data.message);
    }
    return new Error('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ù†ÙØ§Ø°');
  }
}
```

### 3. React Hook Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù†ÙØ§Ø°

```typescript
// hooks/useNafath.ts
import { useState, useCallback } from 'react';
import { NafathService } from '../services/nafathService';

interface UseNafathProps {
  config: NafathConfig;
}

export const useNafath = ({ config }: UseNafathProps) => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [nafathService] = useState(() => new NafathService(config));

  const initiate = useCallback(async (nationalId: string, userId?: number) => {
    setLoading(true);
    setError(null);
    
    try {
      const result = await nafathService.initiate(nationalId, userId);
      return result;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [nafathService]);

  const checkStatus = useCallback(async (nationalId: string, userId?: number) => {
    setLoading(true);
    setError(null);
    
    try {
      const result = await nafathService.checkStatus(nationalId, userId);
      return result;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [nafathService]);

  const signContract = useCallback(async (
    nationalId: string,
    contractData: ContractData,
    userId?: number
  ) => {
    setLoading(true);
    setError(null);
    
    try {
      const result = await nafathService.signContract(nationalId, contractData, userId);
      return result;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [nafathService]);

  const pollStatus = useCallback(async (
    nationalId: string,
    userId?: number,
    interval?: number,
    maxAttempts?: number
  ) => {
    setLoading(true);
    setError(null);
    
    try {
      const result = await nafathService.pollStatus(nationalId, userId, interval, maxAttempts);
      return result;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [nafathService]);

  return {
    initiate,
    checkStatus,
    signContract,
    pollStatus,
    loading,
    error,
    clearError: () => setError(null),
  };
};
```

### 4. React Components

```typescript
// components/NafathAuth.tsx
import React, { useState } from 'react';
import { useNafath } from '../hooks/useNafath';

interface NafathAuthProps {
  config: NafathConfig;
  onSuccess: (data: CheckStatusResponse) => void;
  onError: (error: string) => void;
}

export const NafathAuth: React.FC<NafathAuthProps> = ({
  config,
  onSuccess,
  onError,
}) => {
  const [nationalId, setNationalId] = useState('');
  const [isPolling, setIsPolling] = useState(false);
  const { initiate, pollStatus, loading, error } = useNafath({ config });

  const handleInitiate = async () => {
    if (!nationalId || nationalId.length < 10) {
      onError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡ÙˆÙŠØ© ØµØ­ÙŠØ­');
      return;
    }

    try {
      const result = await initiate(nationalId);
      
      if (result.status === 'sent') {
        setIsPolling(true);
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø©
        const statusResult = await pollStatus(nationalId);
        
        if (statusResult.status === 'approved') {
          onSuccess(statusResult);
        } else {
          onError('ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©');
        }
      } else {
        onError(result.message || 'ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚');
      }
    } catch (err) {
      onError(err instanceof Error ? err.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹');
    } finally {
      setIsPolling(false);
    }
  };

  return (
    <div className="nafath-auth-container">
      <div className="form-group">
        <label htmlFor="nationalId">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©</label>
        <input
          type="text"
          id="nationalId"
          value={nationalId}
          onChange={(e) => setNationalId(e.target.value)}
          placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ©"
          maxLength={10}
          disabled={loading || isPolling}
        />
      </div>

      <button
        onClick={handleInitiate}
        disabled={loading || isPolling || !nationalId}
        className="nafath-button"
      >
        {loading || isPolling ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...' : 'Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± Ù†ÙØ§Ø°'}
      </button>

      {isPolling && (
        <div className="polling-message">
          <p>ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚. ÙŠØ±Ø¬Ù‰ ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ù†ÙØ§Ø° Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©.</p>
          <div className="spinner"></div>
        </div>
      )}

      {error && (
        <div className="error-message">
          {error}
        </div>
      )}
    </div>
  );
};
```

```typescript
// components/ContractSigner.tsx
import React, { useState } from 'react';
import { useNafath } from '../hooks/useNafath';

interface ContractSignerProps {
  config: NafathConfig;
  nationalId: string;
  userId?: number;
  onSuccess: (signedFileUrl: string) => void;
  onError: (error: string) => void;
}

export const ContractSigner: React.FC<ContractSignerProps> = ({
  config,
  nationalId,
  userId,
  onSuccess,
  onError,
}) => {
  const [contractData, setContractData] = useState<ContractData>({
    company_name: 'Ø´Ø±ÙƒØ© Ø´Ù„Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',
    city: '',
    neighborhood: '',
    house_type: '',
    contract_terms: 'Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©...',
  });

  const { signContract, loading, error } = useNafath({ config });

  const handleSign = async () => {
    if (!contractData.city || !contractData.neighborhood || !contractData.house_type) {
      onError('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
      return;
    }

    try {
      const result = await signContract(nationalId, contractData, userId);
      
      if (result.signed && result.file_url) {
        onSuccess(result.file_url);
      } else {
        onError(result.error || 'ÙØ´Ù„ ÙÙŠ ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯');
      }
    } catch (err) {
      onError(err instanceof Error ? err.message : 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹');
    }
  };

  return (
    <div className="contract-signer-container">
      <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯</h3>
      
      <div className="form-group">
        <label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label>
        <input
          type="text"
          value={contractData.city}
          onChange={(e) => setContractData({...contractData, city: e.target.value})}
          placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©"
        />
      </div>

      <div className="form-group">
        <label>Ø§Ù„Ø­ÙŠ</label>
        <input
          type="text"
          value={contractData.neighborhood}
          onChange={(e) => setContractData({...contractData, neighborhood: e.target.value})}
          placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø­ÙŠ"
        />
      </div>

      <div className="form-group">
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø³ÙƒÙ†</label>
        <select
          value={contractData.house_type}
          onChange={(e) => setContractData({...contractData, house_type: e.target.value})}
        >
          <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø³ÙƒÙ†</option>
          <option value="villa">ÙÙŠÙ„Ø§</option>
          <option value="apartment">Ø´Ù‚Ø©</option>
          <option value="traditional">Ø¨ÙŠØª Ø´Ø¹Ø¨ÙŠ</option>
        </select>
      </div>

      <button
        onClick={handleSign}
        disabled={loading}
        className="sign-button"
      >
        {loading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹...' : 'ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯'}
      </button>

      {error && (
        <div className="error-message">
          {error}
        </div>
      )}
    </div>
  );
};
```

### 5. ØµÙØ­Ø© Next.js ÙƒØ§Ù…Ù„Ø©

```typescript
// pages/nafath-demo.tsx
import React, { useState } from 'react';
import { NafathAuth } from '../components/NafathAuth';
import { ContractSigner } from '../components/ContractSigner';

const NafathDemo: React.FC = () => {
  const [step, setStep] = useState<'auth' | 'contract' | 'completed'>('auth');
  const [authData, setAuthData] = useState<CheckStatusResponse | null>(null);
  const [signedFileUrl, setSignedFileUrl] = useState<string>('');

  const nafathConfig: NafathConfig = {
    thumbPrint: process.env.NEXT_PUBLIC_NAFATH_THUMBPRINT!,
    accountId: process.env.NEXT_PUBLIC_NAFATH_ACCOUNT_ID!,
    baseUrl: process.env.NEXT_PUBLIC_NAFATH_BASE_URL!,
  };

  const handleAuthSuccess = (data: CheckStatusResponse) => {
    setAuthData(data);
    setStep('contract');
  };

  const handleAuthError = (error: string) => {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚:', error);
    alert(error);
  };

  const handleSignSuccess = (fileUrl: string) => {
    setSignedFileUrl(fileUrl);
    setStep('completed');
  };

  const handleSignError = (error: string) => {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹:', error);
    alert(error);
  };

  const resetDemo = () => {
    setStep('auth');
    setAuthData(null);
    setSignedFileUrl('');
  };

  return (
    <div className="nafath-demo">
      <div className="container">
        <h1>Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ù†ÙØ§Ø°</h1>
        
        <div className="progress-bar">
          <div className={`step ${step === 'auth' ? 'active' : step !== 'auth' ? 'completed' : ''}`}>
            1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©
          </div>
          <div className={`step ${step === 'contract' ? 'active' : step === 'completed' ? 'completed' : ''}`}>
            2. ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯
          </div>
          <div className={`step ${step === 'completed' ? 'active' : ''}`}>
            3. Ù…ÙƒØªÙ…Ù„
          </div>
        </div>

        {step === 'auth' && (
          <div className="step-content">
            <h2>Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© Ø¹Ø¨Ø± Ù†ÙØ§Ø°</h2>
            <NafathAuth
              config={nafathConfig}
              onSuccess={handleAuthSuccess}
              onError={handleAuthError}
            />
          </div>
        )}

        {step === 'contract' && authData && (
          <div className="step-content">
            <h2>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯</h2>
            <div className="user-info">
              <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> {authData.full_name_ar}</p>
              <p><strong>Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©:</strong> {authData.national_id}</p>
            </div>
            <ContractSigner
              config={nafathConfig}
              nationalId={authData.national_id}
              onSuccess={handleSignSuccess}
              onError={handleSignError}
            />
          </div>
        )}

        {step === 'completed' && (
          <div className="step-content">
            <h2>ØªÙ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­! âœ…</h2>
            <div className="success-message">
              <p>ØªÙ… ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù….</p>
              {signedFileUrl && (
                <div className="file-download">
                  <a
                    href={signedFileUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="download-button"
                  >
                    ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹
                  </a>
                </div>
              )}
              <button onClick={resetDemo} className="reset-button">
                Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

export default NafathDemo;
```

## ğŸ”§ Backend Implementation (Node.js/Express)

### 1. Express Routes

```typescript
// routes/nafath.ts
import express from 'express';
import { NafathController } from '../controllers/nafathController';

const router = express.Router();
const nafathController = new NafathController();

router.post('/initiate', nafathController.initiate);
router.post('/check-status', nafathController.checkStatus);
router.post('/callback', nafathController.callback);
router.post('/sign', nafathController.sign);

export { router as nafathRoutes };
```

### 2. Controller Implementation

```typescript
// controllers/nafathController.ts
import { Request, Response } from 'express';
import axios from 'axios';
import { v4 as uuidv4 } from 'uuid';
import { PDFDocument, StandardFonts } from 'pdf-lib';
import { NafathRequestModel } from '../models/nafathRequest';

export class NafathController {
  private nafathConfig = {
    thumbPrint: process.env.NAFATH_THUMBPRINT!,
    accountId: process.env.NAFATH_ACCOUNT_ID!,
    baseUrl: process.env.NAFATH_BASE_URL!,
  };

  async initiate(req: Request, res: Response) {
    try {
      const { national_id, user_id } = req.body;

      if (!national_id || national_id.length < 10) {
        return res.status(400).json({
          status: 'error',
          message: 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù…Ø·Ù„ÙˆØ¨ ÙˆÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 10 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„'
        });
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø·Ù„Ø¨ Ø³Ø§Ø¨Ù‚
      const existing = await NafathRequestModel.findOne({
        national_id,
        user_id: user_id || null,
        status: 'approved'
      });

      if (existing) {
        return res.status(400).json({
          status: 'error',
          message: 'ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨ Ù…Ø¹ØªÙ…Ø¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…'
        });
      }

      const requestId = uuidv4();
      const webhookUrl = `${process.env.BASE_URL}/api/nafath/callback`;

      // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ù†ÙØ§Ø°
      const response = await axios.post(
        `${this.nafathConfig.baseUrl}/Authentication/Authority/IntegrationNafathAuth`,
        {
          nationalIds: [national_id],
          requestId,
          accountId: this.nafathConfig.accountId,
          webHookUrl: webhookUrl
        },
        {
          headers: {
            'thumbPrint': this.nafathConfig.thumbPrint,
            'accountId': this.nafathConfig.accountId,
            'Content-Type': 'application/json',
          }
        }
      );

      const external = response.data;

      if (external[0]?.error && external[0].error !== "Success") {
        return res.status(422).json({
          status: 'error',
          request_id: requestId,
          message: external[0].message || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©',
          code: external[0].code || null,
          external_response: external,
        });
      }

      // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      await NafathRequestModel.create({
        request_id: requestId,
        user_id: user_id || null,
        national_id,
        status: 'pending',
      });

      res.json({
        status: 'sent',
        request_id: requestId,
        message: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚. ÙŠØ±Ø¬Ù‰ ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ù†ÙØ§Ø° Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©.',
        external_response: external,
      });

    } catch (error) {
      console.error('Error in nafath initiate:', error);
      res.status(500).json({
        status: 'error',
        message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…'
      });
    }
  }

  async checkStatus(req: Request, res: Response) {
    try {
      const { national_id, user_id } = req.body;

      const nafath = await NafathRequestModel.findOne({
        national_id,
        user_id: user_id || null,
      });

      if (!nafath) {
        return res.status(404).json({
          status: 'not_found',
          message: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ù…Ø·Ø§Ø¨Ù‚.',
        });
      }

      const fullNameAr = [
        nafath.first_name_ar,
        nafath.middle_name_ar,
        nafath.last_name_ar
      ].filter(Boolean).join(' ').trim();

      res.json({
        status: nafath.status,
        national_id: nafath.national_id,
        request_id: nafath.request_id,
        full_name_ar: fullNameAr,
        signed_file_url: nafath.signed_file_path 
          ? `${process.env.BASE_URL}/storage/${nafath.signed_file_path}` 
          : null,
      });

    } catch (error) {
      console.error('Error in nafath checkStatus:', error);
      res.status(500).json({
        status: 'error',
        message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…'
      });
    }
  }

  async callback(req: Request, res: Response) {
    try {
      console.log('Nafath callback received:', req.body);

      const { requestId, Status, usersInfo } = req.body;
      const statusCode = parseInt(Status);

      const nafath = await NafathRequestModel.findOne({ request_id: requestId });

      if (!nafath) {
        console.warn('Nafath request not found for requestId:', requestId);
        return res.status(404).json({ message: 'Nafath request not found.' });
      }

      if (statusCode === 1) {
        // ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚
        nafath.status = 'failed';
        await nafath.save();

        console.log('Nafath authentication failed', { requestId });
        return res.json({ message: 'Nafath authentication failed.' });
      }

      if (statusCode === 0) {
        // Ù†Ø¬Ø­ Ø§Ù„ØªØ­Ù‚Ù‚
        const userInfo = usersInfo?.[0] || {};

        nafath.status = 'approved';
        nafath.first_name_en = userInfo.FirstNameEn || null;
        nafath.first_name_ar = userInfo.FirstNameAr || null;
        nafath.middle_name_en = userInfo.MiddleNameEn || null;
        nafath.middle_name_ar = userInfo.MiddleNameAr || null;
        nafath.third_name_en = userInfo.ThirdNameEn || null;
        nafath.third_name_ar = userInfo.ThirdNameAr || null;
        nafath.last_name_en = userInfo.LastNameEn || null;
        nafath.last_name_ar = userInfo.LastNameAr || null;

        await nafath.save();

        console.log('Nafath authentication approved', { requestId });
        return res.json({ message: 'User authenticated successfully.' });
      }

      console.error('Unhandled status code received', { requestId, Status: statusCode });
      res.status(400).json({ message: 'Unhandled status code' });

    } catch (error) {
      console.error('Error in nafath callback:', error);
      res.status(500).json({ message: 'Internal server error' });
    }
  }

  async sign(req: Request, res: Response) {
    try {
      const { national_id, user_id, contract_data } = req.body;

      const nafath = await NafathRequestModel.findOne({
        national_id,
        user_id: user_id || null,
        status: 'approved'
      });

      if (!nafath) {
        return res.status(403).json({
          signed: false,
          error: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ù…Ø·Ø§Ø¨Ù‚ Ø£Ùˆ Ù„Ù… ØªØªÙ… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø¹Ø¯.'
        });
      }

      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯
      const fullName = [
        nafath.first_name_ar,
        nafath.middle_name_ar,
        nafath.last_name_ar
      ].filter(Boolean).join(' ').trim();

      const contractHtml = this.generateContractHtml({
        ...contract_data,
        national_id: nafath.national_id,
        fullname: fullName,
      });

      // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ PDF
      const pdfBytes = await this.generatePDF(contractHtml);
      const base64File = Buffer.from(pdfBytes).toString('base64');
      const fileName = `contract_${nafath.request_id}.pdf`;

      // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ØªÙˆÙ‚ÙŠØ¹
      const signResponse = await this.sendToNafathForSigning(
        nafath.request_id,
        fileName,
        base64File
      );

      if (signResponse.status === 200) {
        const signedPdf = Buffer.from(signResponse.data, 'base64');
        const filePath = `nafath_signed/${nafath.request_id}.pdf`;
        
        // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
        await this.saveFile(filePath, signedPdf);
        
        nafath.signed_file_path = filePath;
        await nafath.save();

        res.json({
          signed: true,
          message: 'ØªÙ… ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨Ù†Ø¬Ø§Ø­',
          file_url: `${process.env.BASE_URL}/storage/${filePath}`,
        });
      } else {
        res.status(500).json({
          signed: false,
          error: 'ÙØ´Ù„ ÙÙŠ ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø¯',
          details: signResponse.data,
        });
      }

    } catch (error) {
      console.error('Error in nafath sign:', error);
      res.status(500).json({
        signed: false,
        error: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…'
      });
    }
  }

  private async sendToNafathForSigning(
    requestId: string,
    fileName: string,
    base64File: string
  ) {
    return await axios.post(
      `${this.nafathConfig.baseUrl}/IntegrationService/SadqESign/Nafath/Sign`,
      {
        RequestId: requestId,
        File: {
          fileName,
          File: base64File,
        },
      },
      {
        headers: {
          'thumbPrint': this.nafathConfig.thumbPrint,
          'accountId': this.nafathConfig.accountId,
          'Content-Type': 'application/json',
          'accept': 'text/plain',
        }
      }
    );
  }

  private generateContractHtml(data: any): string {
    return `
    <!DOCTYPE html>
    <html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8">
        <title>Ø¹Ù‚Ø¯ Ø®Ø¯Ù…Ø©</title>
        <style>
            body { 
                font-family: 'Arial', sans-serif; 
                direction: rtl; 
                line-height: 1.6;
                margin: 40px;
            }
            .container { text-align: center; }
            .header { margin-bottom: 30px; }
            .content { text-align: justify; margin: 20px 0; }
            .section-title { font-weight: bold; margin-top: 20px; }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>Ø¹Ù‚Ø¯ Ø®Ø¯Ù…Ø©</h1>
                <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯: ${new Date().toLocaleDateString('ar-SA')}</p>
            </div>
            
            <div class="content">
                <div class="section-title">Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„: Ø§Ù„Ø´Ø±ÙƒØ©</div>
                <p>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©: ${data.company_name}</p>
                
                <div class="section-title">Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø¹Ù…ÙŠÙ„</div>
                <p>Ø§Ù„Ø§Ø³Ù…: ${data.fullname}</p>
                <p>Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: ${data.national_id}</p>
                <p>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©: ${data.city}</p>
                <p>Ø§Ù„Ø­ÙŠ: ${data.neighborhood}</p>
                <p>Ù†ÙˆØ¹ Ø§Ù„Ø³ÙƒÙ†: ${data.house_type}</p>
                
                <div class="section-title">Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¹Ù‚Ø¯</div>
                <p>${data.contract_terms || 'Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯...'}</p>
            </div>
        </div>
    </body>
    </html>`;
  }

  private async generatePDF(html: string): Promise<Uint8Array> {
    // ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© Ù…Ø«Ù„ puppeteer Ø£Ùˆ playwright Ù„ØªØ­ÙˆÙŠÙ„ HTML Ø¥Ù„Ù‰ PDF
    // Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ù…Ø¨Ø³Ø·
    const pdfDoc = await PDFDocument.create();
    const page = pdfDoc.addPage();
    const { width, height } = page.getSize();
    
    const font = await pdfDoc.embedFont(StandardFonts.Helvetica);
    
    page.drawText('Ø¹Ù‚Ø¯ Ø®Ø¯Ù…Ø©', {
      x: width / 2 - 50,
      y: height - 100,
      size: 20,
      font,
    });
    
    return await pdfDoc.save();
  }

  private async saveFile(filePath: string, data: Buffer): Promise<void> {
    // ØªÙ†ÙÙŠØ° Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
    const fs = require('fs').promises;
    const path = require('path');
    
    const fullPath = path.join(process.env.STORAGE_PATH || './storage', filePath);
    const dir = path.dirname(fullPath);
    
    await fs.mkdir(dir, { recursive: true });
    await fs.writeFile(fullPath, data);
  }
}
```

## ğŸ“„ Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…ØªÙˆÙØ±Ø©

ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¹Ù„Ù‰ **3 Ù‚ÙˆØ§Ù„Ø¨ Ø¹Ù‚ÙˆØ¯ Ù…Ø®ØªÙ„ÙØ©** Ù„Ø®Ø¯Ù…Ø© 3 Ø®Ø·ÙˆØ· Ø£Ø¹Ù…Ø§Ù„ Ù…Ù†ÙØµÙ„Ø©:

### 1. ğŸ’³ Ø¹Ù‚Ø¯ Ø®Ø¯Ù…Ø© Ù‚ÙŠØ¯Ù‡Ø§ (Buy Now Pay Later)
**Ø§Ù„Ù…Ù„Ù:** `contract_with_nafath.blade.php`
**Ø§Ù„ØºØ±Ø¶:** Ø®Ø¯Ù…Ø© "Ø§Ø´ØªØ± Ø§Ù„Ø¢Ù† ÙˆØ§Ø¯ÙØ¹ Ù…Ø¹ Ø§Ù„Ø±Ø§ØªØ¨"

**Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**
- âœ… Ø®Ø¯Ù…Ø© ØªÙ…ÙˆÙŠÙ„ Ù‚ØµÙŠØ± Ø§Ù„Ø£Ø¬Ù„ Ù„Ù„Ù…Ø³ØªÙ‡Ù„ÙƒÙŠÙ†
- âœ… Ø­Ø¯ Ø§Ø¦ØªÙ…Ø§Ù†ÙŠ ÙŠØµÙ„ Ø¥Ù„Ù‰ 2500 Ø±ÙŠØ§Ù„
- âœ… ÙØªØ±Ø© Ø³Ø¯Ø§Ø¯ Ù…Ø±Ù†Ø© Ø­ØªÙ‰ 40 ÙŠÙˆÙ…
- âœ… Ø¨Ø¯ÙˆÙ† ÙÙˆØ§Ø¦Ø¯ Ø±Ø¨ÙˆÙŠØ© (Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø´Ø±ÙŠØ¹Ø©)
- âœ… ÙŠØºØ·ÙŠ Ø´Ø±ÙˆØ· Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ ÙˆØ§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**
```typescript
interface QidhaContractData {
  national_id: string;
  city: string;
  neighborhood: string;
  house_type: string;
  fullname: string;
}
```

### 2. ğŸ“ˆ Ø¹Ù‚Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± (Investment Contract)
**Ø§Ù„Ù…Ù„Ù:** `investor/contract_pdf.blade.php`
**Ø§Ù„ØºØ±Ø¶:** Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©

**Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**
- ğŸ’° Ø§Ø³ØªØ«Ù…Ø§Ø± Ø·ÙˆÙŠÙ„ Ø§Ù„Ø£Ø¬Ù„ (1-3 Ø³Ù†ÙˆØ§Øª)
- ğŸ’° Ø¹ÙˆØ§Ø¦Ø¯ Ø´Ù‡Ø±ÙŠØ© Ø«Ø§Ø¨ØªØ© 4.5%
- ğŸ’° Ù†ÙˆØ¹Ø§Ù† Ù…Ù† Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± (Ø±Ø£Ø³ÙŠ/Ø£ÙÙ‚ÙŠ)
- ğŸ’° Ø¶Ù…Ø§Ù† Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ ÙˆØ§Ù„Ø£Ø±Ø¨Ø§Ø­
- ğŸ’° Ø­Ø¯ Ø£Ø¯Ù†Ù‰ 1000 Ø±ÙŠØ§Ù„ØŒ Ø­Ø¯ Ø£Ù‚ØµÙ‰ 300,000 Ø±ÙŠØ§Ù„

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**
```typescript
interface InvestmentContractData {
  national_id: string;
  first_name: string;
  family_name: string;
  phone: string;
  email: string;
  region: string;
  amount: number;
  investment_type: 'vertical' | 'horizontal';
}
```

### 3. ğŸï¸ Ø¹Ù‚Ø¯ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ³Ù‡ÙŠÙ„ (Logistics/Motorcycle Contract)
**Ø§Ù„Ù…Ù„Ù:** `portal-logistice/contract_pdf.blade.php`
**Ø§Ù„ØºØ±Ø¶:** Ø¨ÙŠØ¹ ÙˆØªØ£Ø¬ÙŠØ± Ø§Ù„Ø¯Ø±Ø§Ø¬Ø§Øª Ø§Ù„Ù†Ø§Ø±ÙŠØ© Ù„Ù„ØªÙˆØµÙŠÙ„

**Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**
- ğŸï¸ Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù…Ù„ Ù…Ø®ØªÙ„Ø· (Ø¨ÙŠØ¹ + Ø¥ÙŠØ¬Ø§Ø±)
- ğŸï¸ ØªÙ…Ù„Ùƒ Ø¬Ø²Ø¦ÙŠ Ø£Ùˆ ÙƒØ§Ù…Ù„ Ù„Ù„Ø¯Ø±Ø§Ø¬Ø©
- ğŸï¸ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© 6600 Ø±ÙŠØ§Ù„ (5000 Ø£ØµÙ„ + 1600 ØªØ¬Ù‡ÙŠØ²)
- ğŸï¸ ÙØªØ±Ø© Ø³Ø¯Ø§Ø¯ 60 ÙŠÙˆÙ… Ù„Ù„ØªÙ…Ù„Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„
- ğŸï¸ Ø¥ÙŠØ¬Ø§Ø± Ø´Ù‡Ø±ÙŠ 660 Ø±ÙŠØ§Ù„ Ù„Ù…Ø¯Ø© 3 Ø³Ù†ÙˆØ§Øª
- ğŸï¸ ØªØ£Ù…ÙŠÙ† Ø´Ø§Ù…Ù„ ÙˆØªØªØ¨Ø¹ GPS

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**
```typescript
interface LogisticsContractData {
  national_id: string;
  first_name: string;
  family_name: string;
  phone: string;
  region: string;
  type: 0 | 1 | 2; // 0=both, 1=sale only, 2=rent only
}
```

## ğŸ¯ Ù„Ù…Ø§Ø°Ø§ 3 Ù‚ÙˆØ§Ù„Ø¨ Ù…Ù†ÙØµÙ„Ø©ØŸ

### **Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©:**
1. **Ø®Ø·ÙˆØ· Ø£Ø¹Ù…Ø§Ù„ Ù…Ø®ØªÙ„ÙØ©** - ÙƒÙ„ Ø®Ø¯Ù…Ø© Ù„Ù‡Ø§ Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù…Ù„ Ù…Ù†ÙØµÙ„
2. **Ø¬Ù…Ø§Ù‡ÙŠØ± Ù…Ø®ØªÙ„ÙØ©** - Ù…Ø³ØªÙ‡Ù„ÙƒÙˆÙ†ØŒ Ù…Ø³ØªØ«Ù…Ø±ÙˆÙ†ØŒ Ø³Ø§Ø¦Ù‚Ùˆ ØªÙˆØµÙŠÙ„
3. **Ù…ØªØ·Ù„Ø¨Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…Ø®ØªÙ„ÙØ©** - ÙƒÙ„ Ù‚Ø·Ø§Ø¹ Ù„Ù‡ Ù„ÙˆØ§Ø¦Ø­ Ø®Ø§ØµØ©
4. **Ø´Ø±ÙˆØ· Ù…Ø§Ù„ÙŠØ© Ù…Ø®ØªÙ„ÙØ©** - ÙØªØ±Ø§Øª Ø³Ø¯Ø§Ø¯ ÙˆØ¶Ù…Ø§Ù†Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©

### **Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªÙ‚Ù†ÙŠØ©:**
```php
// Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬ - ÙŠØ¯Ø¹Ù… Ø¹Ù‚ÙˆØ¯ Ù…ØªØ¹Ø¯Ø¯Ø©
if($data['type'] == 1 || $data['type'] == 0) {
    // Ø¹Ù‚Ø¯ Ø§Ù„Ø¨ÙŠØ¹
    echo '<h1>Ø¹Ù‚Ø¯ Ø¨ÙŠØ¹ Ø¯Ø±Ø§Ø¬Ø© Ù†Ø§Ø±ÙŠØ©</h1>';
}
if($data['type'] == 2 || $data['type'] == 0) {
    // Ø¹Ù‚Ø¯ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±  
    echo '<h1>Ø¹Ù‚Ø¯ Ø§Ø³ØªØ¦Ø¬Ø§Ø± Ø¯Ø±Ø§Ø¬Ø© Ù†Ø§Ø±ÙŠØ©</h1>';
}
```

### **Controllers Ù…Ù†ÙØµÙ„Ø©:**
- `NafathAuthController` â†’ Ù‚ÙŠØ¯Ù‡Ø§
- `InvestorAuthController` â†’ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±
- `PortalLogisticeAuthController` â†’ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ³Ù‡ÙŠÙ„

## ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©

### 1. Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
```typescript
// middleware/security.ts
import rateLimit from 'express-rate-limit';
import helmet from 'helmet';

// ØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
export const nafathRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 Ø¯Ù‚ÙŠÙ‚Ø©
  max: 10, // 10 Ø·Ù„Ø¨Ø§Øª ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰
  message: 'ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª',
});

// Ø­Ù…Ø§ÙŠØ© Headers
export const securityHeaders = helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"],
    },
  },
});
```

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
```typescript
// validators/nafathValidator.ts
import Joi from 'joi';

export const initiateSchema = Joi.object({
  national_id: Joi.string().pattern(/^\d{10}$/).required(),
  user_id: Joi.number().integer().positive().optional(),
});

export const contractSchema = Joi.object({
  national_id: Joi.string().pattern(/^\d{10}$/).required(),
  user_id: Joi.number().integer().positive().optional(),
  contract_data: Joi.object({
    company_name: Joi.string().required(),
    city: Joi.string().required(),
    neighborhood: Joi.string().required(),
    house_type: Joi.string().required(),
    contract_terms: Joi.string().optional(),
  }).required(),
});
```

### 3. ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
```typescript
// utils/encryption.ts
import crypto from 'crypto';

const ENCRYPTION_KEY = process.env.ENCRYPTION_KEY!;
const ALGORITHM = 'aes-256-gcm';

export const encrypt = (text: string): string => {
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipher(ALGORITHM, ENCRYPTION_KEY);
  cipher.setAAD(Buffer.from('nafath-data'));
  
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  
  const authTag = cipher.getAuthTag();
  
  return iv.toString('hex') + ':' + authTag.toString('hex') + ':' + encrypted;
};

export const decrypt = (encryptedData: string): string => {
  const parts = encryptedData.split(':');
  const iv = Buffer.from(parts[0], 'hex');
  const authTag = Buffer.from(parts[1], 'hex');
  const encrypted = parts[2];
  
  const decipher = crypto.createDecipher(ALGORITHM, ENCRYPTION_KEY);
  decipher.setAAD(Buffer.from('nafath-data'));
  decipher.setAuthTag(authTag);
  
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  
  return decrypted;
};
```

## ğŸ“Š Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„

### 1. Logging System
```typescript
// utils/logger.ts
import winston from 'winston';

export const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.errors({ stack: true }),
    winston.format.json()
  ),
  defaultMeta: { service: 'nafath-service' },
  transports: [
    new winston.transports.File({ filename: 'logs/error.log', level: 'error' }),
    new winston.transports.File({ filename: 'logs/combined.log' }),
  ],
});

if (process.env.NODE_ENV !== 'production') {
  logger.add(new winston.transports.Console({
    format: winston.format.simple()
  }));
}
```

### 2. Metrics Collection
```typescript
// utils/metrics.ts
interface NafathMetrics {
  totalRequests: number;
  successfulVerifications: number;
  failedVerifications: number;
  contractsSigned: number;
  averageProcessingTime: number;
}

class MetricsCollector {
  private metrics: NafathMetrics = {
    totalRequests: 0,
    successfulVerifications: 0,
    failedVerifications: 0,
    contractsSigned: 0,
    averageProcessingTime: 0,
  };

  incrementTotalRequests() {
    this.metrics.totalRequests++;
  }

  incrementSuccessfulVerifications() {
    this.metrics.successfulVerifications++;
  }

  incrementFailedVerifications() {
    this.metrics.failedVerifications++;
  }

  incrementContractsSigned() {
    this.metrics.contractsSigned++;
  }

  updateAverageProcessingTime(time: number) {
    this.metrics.averageProcessingTime = 
      (this.metrics.averageProcessingTime + time) / 2;
  }

  getMetrics(): NafathMetrics {
    return { ...this.metrics };
  }

  getSuccessRate(): number {
    if (this.metrics.totalRequests === 0) return 0;
    return (this.metrics.successfulVerifications / this.metrics.totalRequests) * 100;
  }
}

export const metricsCollector = new MetricsCollector();
```

## ğŸš€ Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Deployment)

### 1. Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
```bash
# .env
NAFATH_THUMBPRINT=your_certificate_thumbprint
NAFATH_ACCOUNT_ID=your_account_id  
NAFATH_BASE_URL=https://apigw.sadq.sa

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/nafath_db

# Security
ENCRYPTION_KEY=your-32-character-encryption-key
JWT_SECRET=your-jwt-secret

# Storage
STORAGE_PATH=./storage
BASE_URL=https://your-domain.com

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=10
```

### 2. Docker Configuration
```dockerfile
# Dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
    env_file:
      - .env
    depends_on:
      - db
      - redis

  db:
    image: postgres:14
    environment:
      POSTGRES_DB: nafath_db
      POSTGRES_USER: nafath_user
      POSTGRES_PASSWORD: secure_password
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

volumes:
  postgres_data:
  redis_data:
```

## ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…

### 1. Unit Tests
```typescript
// tests/nafath.test.ts
import { describe, it, expect, beforeEach, jest } from '@jest/globals';
import { NafathService } from '../services/nafathService';

describe('NafathService', () => {
  let nafathService: NafathService;
  
  beforeEach(() => {
    nafathService = new NafathService({
      thumbPrint: 'test-thumbprint',
      accountId: 'test-account',
      baseUrl: 'https://test-api.com'
    });
  });

  it('should initiate verification successfully', async () => {
    const mockResponse = {
      status: 'sent',
      request_id: 'test-request-id',
      external_response: [{ error: 'Success' }]
    };

    jest.spyOn(axios, 'post').mockResolvedValue({ data: mockResponse });

    const result = await nafathService.initiate('1234567890');
    
    expect(result.status).toBe('sent');
    expect(result.request_id).toBe('test-request-id');
  });

  it('should handle verification failure', async () => {
    const mockResponse = {
      status: 'error',
      message: 'ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚'
    };

    jest.spyOn(axios, 'post').mockResolvedValue({ data: mockResponse });

    await expect(nafathService.initiate('invalid-id'))
      .rejects
      .toThrow('ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚');
  });
});
```

### 2. Integration Tests
```typescript
// tests/integration/nafath.integration.test.ts
import request from 'supertest';
import { app } from '../app';

describe('Nafath Integration Tests', () => {
  it('should complete full nafath flow', async () => {
    // 1. Initiate verification
    const initiateResponse = await request(app)
      .post('/api/nafath/initiate')
      .send({ national_id: '1234567890' })
      .expect(200);

    expect(initiateResponse.body.status).toBe('sent');
    
    // 2. Check status (should be pending)
    const statusResponse = await request(app)
      .post('/api/nafath/check-status')
      .send({ national_id: '1234567890' })
      .expect(200);

    expect(statusResponse.body.status).toBe('pending');

    // 3. Simulate callback
    await request(app)
      .post('/api/nafath/callback')
      .send({
        requestId: initiateResponse.body.request_id,
        Status: 0,
        usersInfo: [{
          FirstNameAr: 'Ø£Ø­Ù…Ø¯',
          MiddleNameAr: 'Ù…Ø­Ù…Ø¯',
          LastNameAr: 'Ø§Ù„Ø³Ø¹ÙŠØ¯'
        }]
      })
      .expect(200);

    // 4. Check status again (should be approved)
    const finalStatusResponse = await request(app)
      .post('/api/nafath/check-status')
      .send({ national_id: '1234567890' })
      .expect(200);

    expect(finalStatusResponse.body.status).toBe('approved');
  });
});
```

## ğŸ“š Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø³ÙŠØ·
```typescript
// Simple usage example
import { useNafath } from './hooks/useNafath';

function SimpleNafathDemo() {
  const { initiate, pollStatus, loading } = useNafath({ config });

  const handleVerify = async () => {
    try {
      await initiate('1234567890');
      const result = await pollStatus('1234567890');
      
      if (result.status === 'approved') {
        alert(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${result.full_name_ar}`);
      }
    } catch (error) {
      alert('ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚');
    }
  };

  return (
    <button onClick={handleVerify} disabled={loading}>
      {loading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...' : 'ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± Ù†ÙØ§Ø°'}
    </button>
  );
}
```

### 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªÙ‚Ø¯Ù… Ù…Ø¹ Redux
```typescript
// Redux integration
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';

export const initiateNafath = createAsyncThunk(
  'nafath/initiate',
  async ({ nationalId, userId }: { nationalId: string; userId?: number }) => {
    const nafathService = new NafathService(nafathConfig);
    return await nafathService.initiate(nationalId, userId);
  }
);

const nafathSlice = createSlice({
  name: 'nafath',
  initialState: {
    loading: false,
    error: null,
    currentRequest: null,
    userInfo: null,
  },
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(initiateNafath.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(initiateNafath.fulfilled, (state, action) => {
        state.loading = false;
        state.currentRequest = action.payload;
      })
      .addCase(initiateNafath.rejected, (state, action) => {
        state.loading = false;
        state.error = action.error.message;
      });
  },
});
```

## ğŸ” Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ù…Ø´Ø§ÙƒÙ„ Ø´Ø§Ø¦Ø¹Ø© ÙˆØ­Ù„ÙˆÙ„Ù‡Ø§

**1. Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©:**
```bash
# ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© NAFATH_THUMBPRINT
curl -X POST "https://apigw.sadq.sa/test" \
  -H "thumbPrint: YOUR_THUMBPRINT" \
  -H "accountId: YOUR_ACCOUNT_ID"
```

**2. Ø¹Ø¯Ù… ÙˆØµÙˆÙ„ callback:**
```bash
# ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù€ URL Ù‚Ø§Ø¨Ù„ Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ù† Ø§Ù„Ø®Ø§Ø±Ø¬
curl -X POST "https://yourdomain.com/api/nafath/callback" \
  -H "Content-Type: application/json" \
  -d '{"test": true}'
```

**3. ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹:**
- ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† PDF ØµØ§Ù„Ø­ ÙˆÙ„ÙŠØ³ ØªØ§Ù„Ù
- ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­)
- ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù‚Ø¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

### Debug Mode
```typescript
// Enable debug logging
const nafathService = new NafathService(config, {
  debug: true,
  logLevel: 'verbose'
});
```

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©

- **Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ù„Ù†ÙØ§Ø°:** [Ø¯Ù„ÙŠÙ„ Ù†ÙØ§Ø° Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ†](https://nafath.sa/developers)
- **Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ:** support@nafath.sa
- **Ø§Ù„Ù…Ø¬ØªÙ…Ø¹:** [Ù…Ù†ØªØ¯Ù‰ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†](https://community.nafath.sa)

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆÙÙ‚Ø§Ù‹ Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ.

---

**Ù…Ù„Ø§Ø­Ø¸Ø©:** ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬.

## ğŸ”„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©

- Ø¯Ø¹Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ©
- ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© PDF
- Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø¹Ù‚ÙˆØ¯
- Ø¯Ø¹Ù… Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©
- ØªØ­Ø³ÙŠÙ† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ù…ØªØ§Ø¨Ø¹Ø© [Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹](https://github.com/your-repo/nafath-integration).
